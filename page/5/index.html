<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/not_advanced_ins.github.io/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/not_advanced_ins.github.io/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/not_advanced_ins.github.io/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/not_advanced_ins.github.io/images/logo.svg" color="#222">

<link rel="stylesheet" href="/not_advanced_ins.github.io/css/main.css">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.3/css/all.min.css" integrity="sha256-2H3fkXt6FEmrReK448mDVGKb3WW2ZZw35gI7vqHOE4Y=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"alberteuler.github.io","root":"/not_advanced_ins.github.io/","images":"/not_advanced_ins.github.io/images","scheme":"Muse","version":"8.5.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":false,"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"}}</script><script src="/not_advanced_ins.github.io/js/config.js"></script>
<meta name="description" content="更不更新看心情">
<meta property="og:type" content="website">
<meta property="og:title" content="不先进摸鱼研究所">
<meta property="og:url" content="https://alberteuler.github.io/not_advanced_ins.github.io/page/5/index.html">
<meta property="og:site_name" content="不先进摸鱼研究所">
<meta property="og:description" content="更不更新看心情">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="Albert -W">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://alberteuler.github.io/not_advanced_ins.github.io/page/5/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":true,"isPost":false,"lang":"en","comments":"","permalink":"","path":"page/5/index.html","title":""}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>不先进摸鱼研究所</title>
  




  <noscript>
    <link rel="stylesheet" href="/not_advanced_ins.github.io/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/not_advanced_ins.github.io/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">不先进摸鱼研究所</h1>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">在hexo上的分站</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu">
        <li class="menu-item menu-item-home"><a href="/not_advanced_ins.github.io/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li>
        <li class="menu-item menu-item-about"><a href="/not_advanced_ins.github.io/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a></li>
        <li class="menu-item menu-item-tags"><a href="/not_advanced_ins.github.io/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a></li>
        <li class="menu-item menu-item-categories"><a href="/not_advanced_ins.github.io/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a></li>
        <li class="menu-item menu-item-archives"><a href="/not_advanced_ins.github.io/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a></li>
        <li class="menu-item menu-item-schedule"><a href="/not_advanced_ins.github.io/schedule/" rel="section"><i class="fa fa-calendar fa-fw"></i>Schedule</a></li>
        <li class="menu-item menu-item-sitemap"><a href="/not_advanced_ins.github.io/sitemap.xml" rel="section"><i class="fa fa-sitemap fa-fw"></i>Sitemap</a></li>
        <li class="menu-item menu-item-commonweal"><a href="/not_advanced_ins.github.io/404/" rel="section"><i class="fa fa-heartbeat fa-fw"></i>Commonweal 404</a></li>
  </ul>
</nav>




</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-overview">
            <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Albert -W"
      src="/not_advanced_ins.github.io/images/avatar.jpg">
  <p class="site-author-name" itemprop="name">Albert -W</p>
  <div class="site-description" itemprop="description">更不更新看心情</div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/not_advanced_ins.github.io/archives/">
        
          <span class="site-state-item-count">61</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/not_advanced_ins.github.io/categories/">
          
        <span class="site-state-item-count">11</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/not_advanced_ins.github.io/tags/">
          
        <span class="site-state-item-count">19</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author site-overview-item animated">
      <span class="links-of-author-item">
        <a href="mailto:jackwjiong@126.com" title="E-Mail → mailto:jackwjiong@126.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>



          </div>
        </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://alberteuler.github.io/not_advanced_ins.github.io/2021/07/07/CircularArray/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/not_advanced_ins.github.io/images/avatar.jpg">
      <meta itemprop="name" content="Albert -W">
      <meta itemprop="description" content="更不更新看心情">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="不先进摸鱼研究所">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/not_advanced_ins.github.io/2021/07/07/CircularArray/" class="post-title-link" itemprop="url">最大子序和-Kanade算法</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2021-07-07 06:30:50" itemprop="dateCreated datePublished" datetime="2021-07-07T06:30:50+08:00">2021-07-07</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">Edited on</span>
        <time title="Modified: 2021-07-10 23:31:09" itemprop="dateModified" datetime="2021-07-10T23:31:09+08:00">2021-07-10</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/not_advanced_ins.github.io/categories/%E7%AE%97%E6%B3%95/" itemprop="url" rel="index"><span itemprop="name">算法</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="最大子序和问题"><a href="#最大子序和问题" class="headerlink" title="最大子序和问题"></a>最大子序和问题</h1><p>给定一个整数数组 nums ，找到一个具有最大和的连续子数组（子数组最少包含一个元素），返回其最大和。<br>这是一个典型的动态规划问题。列出动态规划方程：</p>
<script type="math/tex; mode=display">
dp[i] = max(dp[i-1]+nums[i],nums[i])</script><p>即可很快解决问题。</p>
<h1 id="Kanade算法"><a href="#Kanade算法" class="headerlink" title="Kanade算法"></a>Kanade算法</h1><p>这个算法在1984年由Jay Kadane提出，同样用来解决最大子序和问题。算法暂且描述如下：</p>
<h2 id="算法概述"><a href="#算法概述" class="headerlink" title="算法概述"></a>算法概述</h2><ol>
<li><p>设置两个变量<code>max_ending_here</code>和<code>max_so_far</code>,前者用表示遍历过程中，以当前元素x为结尾的子序列的总和最大值。</p>
</li>
<li><p>从每个位置计算的<code>max_ending_here</code>中，找到最大值，便是全局的最大子数列的值。</p>
</li>
<li><p><code>max_so_far</code>用来记录遍历过程中所发现的最大的<code>max_ending _here</code></p>
</li>
<li><p>一次遍历后，就可以得到问题的答案：<code>max_so_far</code></p>
</li>
</ol>
<p>接下来有一个问题：如何计算<code>max_ending_here</code>?</p>
<p>我们同样用动态规划的思想解决这个问题。用一个数组<code>dp</code>来存储<code>max_ending_here</code>,那么根据题意，应该有：</p>
<script type="math/tex; mode=display">
dp[j] = max_i(A[i] + A[i+1]+...A[j])</script><p>因此有以下的递推式：</p>
<script type="math/tex; mode=display">
dp[j+1] = A[j+1] + max(dp[j],0)</script><p>因为$dp[j+1]$只与$dp[j]$和$A[j+1]$有关，所以用两个变量<code>res</code>和<code>cur</code>分别表示这两个数组的当前值即可。</p>
<h2 id="代码实现"><a href="#代码实现" class="headerlink" title="代码实现"></a>代码实现</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Kanade</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt; &amp;A)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> res = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> cur = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> x:A)&#123;</span><br><span class="line">        cur = x+ <span class="built_in">max</span>(cur,<span class="number">0</span>);</span><br><span class="line">        res = <span class="built_in">max</span>(res,cur);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="引申题目——环形数组的最大子序和"><a href="#引申题目——环形数组的最大子序和" class="headerlink" title="引申题目——环形数组的最大子序和"></a>引申题目——环形数组的最大子序和</h1><h2 id="问题描述"><a href="#问题描述" class="headerlink" title="问题描述"></a>问题描述</h2><p>给定一个由整数数组 A 表示的环形数组 C，求 C 的非空子数组的最大可能和。</p>
<p>在此处，环形数组意味着数组的末端将会与开头相连呈环状。（形式上，当0 &lt;= i &lt; A.length 时 C[i] = A[i]，且当 i &gt;= 0 时 C[i+A.length] = C[i]）</p>
<p>此外，子数组最多只能包含固定缓冲区 A 中的每个元素一次。（形式上，对于子数组 C[i], C[i+1], …, C[j]，不存在 i &lt;= k1, k2 &lt;= j 其中 k1 % A.length = k2 % A.length）</p>
<h2 id="算法概述-1"><a href="#算法概述-1" class="headerlink" title="算法概述"></a>算法概述</h2><p>这个问题可以被拆分为两个子问题：</p>
<ol>
<li>如果当前区间没有跨越首尾（单区间），那么保证这个区间和最大即可。</li>
<li>如果当前区间跨越了首尾（双区间），那么需要保证单区间和最小，双区间和即是总体减去双区间和。递推式如下：</li>
</ol>
<script type="math/tex; mode=display">
dp[i] = min(dp[i-1]+nums[i],nums[i])</script><h2 id="代码实现-1"><a href="#代码实现-1" class="headerlink" title="代码实现"></a>代码实现</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">maxSubarraySumCircular</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; nums)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n = nums.<span class="built_in">size</span>();</span><br><span class="line">        <span class="keyword">if</span>(n==<span class="number">1</span>) <span class="keyword">return</span> nums[<span class="number">0</span>];</span><br><span class="line">        <span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">dp</span><span class="params">(n)</span></span>;</span><br><span class="line">        <span class="comment">//环内的情况</span></span><br><span class="line">        dp[<span class="number">0</span>] = nums[<span class="number">0</span>];</span><br><span class="line">        <span class="keyword">int</span> inner = dp[<span class="number">0</span>];</span><br><span class="line">        <span class="keyword">int</span> sum = <span class="built_in">accumulate</span>(nums.<span class="built_in">begin</span>(),nums.<span class="built_in">end</span>(),<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; n; i++ )&#123;</span><br><span class="line">            dp[i] = <span class="built_in">max</span>(dp[i<span class="number">-1</span>] + nums[i] , nums[i]);</span><br><span class="line">            inner = <span class="built_in">max</span>(dp[i],inner);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> outer = dp[<span class="number">0</span>];</span><br><span class="line">        dp.<span class="built_in">clear</span>();</span><br><span class="line">        dp[<span class="number">0</span>] = nums[<span class="number">0</span>];</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; n; i++ )&#123;</span><br><span class="line">            dp[i] = <span class="built_in">min</span>(dp[i<span class="number">-1</span>] +  nums[i] , nums[i]);</span><br><span class="line">            outer = <span class="built_in">min</span>(dp[i],outer);</span><br><span class="line">        &#125;</span><br><span class="line">        cout&lt;&lt;inner&lt;&lt;<span class="string">&quot; &quot;</span>&lt;&lt;outer&lt;&lt;<span class="string">&quot; &quot;</span>&lt;&lt;sum&lt;&lt;endl;</span><br><span class="line">        <span class="keyword">if</span>(sum==outer) <span class="keyword">return</span> inner;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">max</span>(inner, sum-outer);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://alberteuler.github.io/not_advanced_ins.github.io/2021/06/29/memeory-note-4/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/not_advanced_ins.github.io/images/avatar.jpg">
      <meta itemprop="name" content="Albert -W">
      <meta itemprop="description" content="更不更新看心情">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="不先进摸鱼研究所">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/not_advanced_ins.github.io/2021/06/29/memeory-note-4/" class="post-title-link" itemprop="url">memeory-note-4</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2021-06-29 18:29:47" itemprop="dateCreated datePublished" datetime="2021-06-29T18:29:47+08:00">2021-06-29</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://alberteuler.github.io/not_advanced_ins.github.io/2021/06/29/trap/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/not_advanced_ins.github.io/images/avatar.jpg">
      <meta itemprop="name" content="Albert -W">
      <meta itemprop="description" content="更不更新看心情">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="不先进摸鱼研究所">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/not_advanced_ins.github.io/2021/06/29/trap/" class="post-title-link" itemprop="url">LeetCode接雨水问题</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2021-06-29 10:21:04" itemprop="dateCreated datePublished" datetime="2021-06-29T10:21:04+08:00">2021-06-29</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">Edited on</span>
        <time title="Modified: 2021-08-29 22:18:30" itemprop="dateModified" datetime="2021-08-29T22:18:30+08:00">2021-08-29</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/not_advanced_ins.github.io/categories/%E7%AE%97%E6%B3%95/" itemprop="url" rel="index"><span itemprop="name">算法</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="题目需求"><a href="#题目需求" class="headerlink" title="题目需求"></a>题目需求</h1><p>给定 n 个非负整数表示每个宽度为 1 的柱子的高度图，计算按此排列的柱子，下雨之后能接多少雨水。</p>
<p><img src="https://assets.leetcode-cn.com/aliyun-lc-upload/uploads/2018/10/22/rainwatertrap.png" alt="image"></p>
<p>示例：<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">输入：height = [0,1,0,2,1,0,1,3,2,1,2,1]</span><br><span class="line">输出：6</span><br><span class="line">解释：上面是由数组 [0,1,0,2,1,0,1,3,2,1,2,1] 表示的高度图，在这种情况下，可以接 6 个单位的雨水（蓝色部分表示雨水）。 </span><br></pre></td></tr></table></figure></p>
<h1 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h1><h2 id="法一"><a href="#法一" class="headerlink" title="法一"></a>法一</h2><p>对于下标 ii，下雨后水能到达的最大高度等于下标 ii 两边的最大高度的最小值，下标 ii 处能接的雨水量等于下标 ii 处的水能到达的最大高度减去 ${height}[i]height[i]$。</p>
<p>朴素的做法是对于数组 $height$ 中的每个元素，分别向左和向右扫描并记录左边和右边的最大高度，然后计算每个下标位置能接的雨水量。假设数组 $\textit{height}height$ 的长度为 nn，该做法需要对每个下标位置使用 $O(n)$ 的时间向两边扫描并得到最大高度，因此总时间复杂度是 $O(n^2)$。</p>
<p>上述做法的时间复杂度较高是因为需要对每个下标位置都向两边扫描。如果已经知道每个位置两边的最大高度，则可以在 $O(n)$ 的时间内得到能接的雨水总量。使用动态规划的方法，可以在$O(n)$ 的时间内预处理得到每个位置两边的最大高度。</p>
<p>创建两个长度为 nn 的数组 $leftMax$ 和 $rightMax$。对于 $0 \le i&lt;n0≤i&lt;n，\textit{leftMax}[i]leftMax[i] $ 表示下标 ii 及其左边的位置中，$\textit{height}height$ 的最大高度，$\textit{rightMax}[i]rightMax[i] $表示下标 ii 及其右边的位置中，$\textit{height}height$ 的最大高度。</p>
<p>显然，</p>
<script type="math/tex; mode=display">
\textit{leftMax}[0]=\textit{height}[0]leftMax[0]=height[0]，</script><script type="math/tex; mode=display">
\textit{rightMax}[n-1]=\textit{height}[n-1]rightMax[n−1]=height[n−1]</script><p>。两个数组的其余元素的计算如下：</p>
<script type="math/tex; mode=display">
当 1 \le i \le n-11≤i≤n−1 时，</script><script type="math/tex; mode=display">
\textit{leftMax}[i]=\max(\textit{leftMax}[i-1], 
\textit{height}[i])leftMax[i]=max(leftMax[i−1],height[i])；</script><script type="math/tex; mode=display">
当 0 \le i \le n-20≤i≤n−2 时，</script><script type="math/tex; mode=display">
\textit{rightMax}[i]=\max(\textit{rightMax}[i+1], 
\textit{height}[i])rightMax[i]=max(rightMax[i+1],height[i])。</script><p>因此可以正向遍历数组 height 得到数组 leftMax 的每个元素值，反向遍历数组 height 得到数组 rightMax 的每个元素值。</p>
<p>在得到数组 leftMax 和 rightMax 的每个元素值之后，对于 $0 \le i&lt;n0≤i&lt;n，$ 下标 ii 处能接的雨水量等于</p>
<script type="math/tex; mode=display">
 \min(\textit{leftMax}[i],\textit{rightMax}[i])-\textit{height}[i]min(leftMax[i],rightMax[i])−height[i]</script><p> 遍历每个下标位置即可得到能接的雨水总量。</p>
<p>动态规划做法可以由下图体现。<br><img src="https://assets.leetcode-cn.com/solution-static/42/1.png" alt="image"></p>
<h2 id="法二"><a href="#法二" class="headerlink" title="法二"></a>法二</h2><h1 id="代码实现"><a href="#代码实现" class="headerlink" title="代码实现"></a>代码实现</h1><h2 id="法一-1"><a href="#法一-1" class="headerlink" title="法一"></a>法一</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">trap</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; height)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n = height.<span class="built_in">size</span>();</span><br><span class="line">        <span class="keyword">if</span> (n == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">leftMax</span><span class="params">(n)</span></span>;</span><br><span class="line">        leftMax[<span class="number">0</span>] = height[<span class="number">0</span>];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; n; ++i) &#123;</span><br><span class="line">            leftMax[i] = <span class="built_in">max</span>(leftMax[i - <span class="number">1</span>], height[i]);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">rightMax</span><span class="params">(n)</span></span>;</span><br><span class="line">        rightMax[n - <span class="number">1</span>] = height[n - <span class="number">1</span>];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = n - <span class="number">2</span>; i &gt;= <span class="number">0</span>; --i) &#123;</span><br><span class="line">            rightMax[i] = <span class="built_in">max</span>(rightMax[i + <span class="number">1</span>], height[i]);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i) &#123;</span><br><span class="line">            ans += <span class="built_in">min</span>(leftMax[i], rightMax[i]) - height[i];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="法二-1"><a href="#法二-1" class="headerlink" title="法二"></a>法二</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">trap</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; height)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line">        stack&lt;<span class="keyword">int</span>&gt; stk;</span><br><span class="line">        <span class="keyword">int</span> n = height.<span class="built_in">size</span>();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i) &#123;</span><br><span class="line">            <span class="keyword">while</span> (!stk.<span class="built_in">empty</span>() &amp;&amp; height[i] &gt; height[stk.<span class="built_in">top</span>()]) &#123;</span><br><span class="line">                <span class="keyword">int</span> top = stk.<span class="built_in">top</span>();</span><br><span class="line">                stk.<span class="built_in">pop</span>();</span><br><span class="line">                <span class="keyword">if</span> (stk.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">int</span> left = stk.<span class="built_in">top</span>();</span><br><span class="line">                <span class="keyword">int</span> currWidth = i - left - <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">int</span> currHeight = <span class="built_in">min</span>(height[left], height[i]) - height[top];</span><br><span class="line">                ans += currWidth * currHeight;</span><br><span class="line">            &#125;</span><br><span class="line">            stk.<span class="built_in">push</span>(i);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://alberteuler.github.io/not_advanced_ins.github.io/2021/06/29/rabinKarp/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/not_advanced_ins.github.io/images/avatar.jpg">
      <meta itemprop="name" content="Albert -W">
      <meta itemprop="description" content="更不更新看心情">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="不先进摸鱼研究所">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/not_advanced_ins.github.io/2021/06/29/rabinKarp/" class="post-title-link" itemprop="url">Rabin-Karp算法</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2021-06-29 09:16:06 / Modified: 09:22:39" itemprop="dateCreated datePublished" datetime="2021-06-29T09:16:06+08:00">2021-06-29</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/not_advanced_ins.github.io/categories/%E7%AE%97%E6%B3%95/" itemprop="url" rel="index"><span itemprop="name">算法</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="简述"><a href="#简述" class="headerlink" title="简述"></a>简述</h1><h1 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h1><h1 id="代码实现"><a href="#代码实现" class="headerlink" title="代码实现"></a>代码实现</h1><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">///@brief a further checking to rule out hashing collision.</span></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">check</span><span class="params">(<span class="keyword">const</span> std::string&amp; str, <span class="keyword">const</span> std::pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt;&amp; p1,</span></span></span><br><span class="line"><span class="params"><span class="function">           <span class="keyword">const</span> std::pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt;&amp; p2)</span> </span>&#123;</span><br><span class="line">  <span class="built_in">assert</span>(p1.first &gt;= <span class="number">0</span> &amp;&amp; p1.second &lt; str.<span class="built_in">length</span>());</span><br><span class="line">  <span class="built_in">assert</span>(p2.first &gt;= <span class="number">0</span> &amp;&amp; p2.second &lt; str.<span class="built_in">length</span>());</span><br><span class="line">  <span class="keyword">int</span> len1 = p1.second - p1.first + <span class="number">1</span>, len2 = p2.second - p2.first + <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">if</span> (len1 != len2) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = p1.first, j = p2.first; i &lt;= p1.second; ++i, ++j) &#123;</span><br><span class="line">    <span class="keyword">if</span> (str[i] != str[j]) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">///@param k the length of a duplicate substring.</span></span><br><span class="line"><span class="comment">///@param dup_str[out] the found duplicate substring if there&#x27;s one.</span></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">find_duplicate_substring</span><span class="params">(<span class="keyword">const</span> std::string&amp; str, <span class="keyword">int</span> b, <span class="keyword">long</span> mod, <span class="keyword">int</span> k,</span></span></span><br><span class="line"><span class="params"><span class="function">                              <span class="keyword">int</span> length, std::string&amp; dup_str,</span></span></span><br><span class="line"><span class="params"><span class="function">                              <span class="keyword">const</span> std::unordered_map&lt;<span class="keyword">char</span>, <span class="keyword">int</span>&gt; ctoi)</span> </span>&#123;</span><br><span class="line">  <span class="built_in">assert</span>(k &lt; length);</span><br><span class="line">  <span class="comment">// rabin-karp: init hashing.</span></span><br><span class="line">  <span class="comment">// key: code, value: &lt;start_idx, end_idx&gt;, right included.</span></span><br><span class="line">  std::unordered_map&lt;<span class="keyword">long</span>, std::pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt;&gt; codes;</span><br><span class="line">  codes.<span class="built_in">reserve</span>(length - k + <span class="number">1</span>);</span><br><span class="line">  <span class="keyword">long</span> code0 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; k; ++i) code0 = (code0 * b + ctoi.<span class="built_in">at</span>(str[i])) % mod;</span><br><span class="line">  codes.<span class="built_in">insert</span>(&#123;code0, &#123;<span class="number">0</span>, k - <span class="number">1</span>&#125;&#125;);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// rabin-karp: rolling hashing.</span></span><br><span class="line">  <span class="comment">///@note use loop to compute power when overflow is at risky.</span></span><br><span class="line">  <span class="keyword">long</span> b_pow_k = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= k; ++i) b_pow_k = b_pow_k * b % mod;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; length - k + <span class="number">1</span>; ++i) &#123;</span><br><span class="line">    <span class="comment">// + mod to make sure code is postive.</span></span><br><span class="line">    <span class="keyword">long</span> code = (code0 * b - ctoi.<span class="built_in">at</span>(str[i - <span class="number">1</span>]) * b_pow_k) % mod + mod;</span><br><span class="line">    <span class="comment">// + mod might make code larger than mod, so mod it again.</span></span><br><span class="line">    code = (code + ctoi.<span class="built_in">at</span>(str[i + k - <span class="number">1</span>])) % mod;</span><br><span class="line">    std::pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; val&#123;i, i + k - <span class="number">1</span>&#125;;</span><br><span class="line">    <span class="keyword">if</span> (codes.<span class="built_in">count</span>(code) == <span class="number">1</span> &amp;&amp; <span class="built_in">check</span>(str, codes.<span class="built_in">at</span>(code), val)) &#123;</span><br><span class="line">      dup_str.<span class="built_in">assign</span>(str.<span class="built_in">substr</span>(i, k));</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    codes.<span class="built_in">insert</span>(&#123;code, val&#125;);</span><br><span class="line">    code0 = code;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://alberteuler.github.io/not_advanced_ins.github.io/2021/06/27/csapp-1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/not_advanced_ins.github.io/images/avatar.jpg">
      <meta itemprop="name" content="Albert -W">
      <meta itemprop="description" content="更不更新看心情">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="不先进摸鱼研究所">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/not_advanced_ins.github.io/2021/06/27/csapp-1/" class="post-title-link" itemprop="url">CSAPP笔记拾遗</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2021-06-27 22:14:56 / Modified: 22:24:03" itemprop="dateCreated datePublished" datetime="2021-06-27T22:14:56+08:00">2021-06-27</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/not_advanced_ins.github.io/categories/%E7%AC%94%E8%AE%B0/" itemprop="url" rel="index"><span itemprop="name">笔记</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="数字电路和处理器设计"><a href="#数字电路和处理器设计" class="headerlink" title="数字电路和处理器设计"></a>数字电路和处理器设计</h1><p>寄存器包括了</p>
<ol>
<li>读端口</li>
<li>写端口<br>宽度为64位。</li>
<li>地址线(4位)<br>硬件描述语言(verilog和VHDL);</li>
</ol>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> regfile(</span><br><span class="line">    <span class="keyword">output</span> <span class="keyword">reg</span>[<span class="number">63</span>:<span class="number">0</span>]    data_out,</span><br><span class="line">    <span class="keyword">input</span>  <span class="keyword">wire</span>[<span class="number">63</span>:<span class="number">0</span>]   data_in,</span><br><span class="line">    <span class="keyword">input</span>  <span class="keyword">wire</span>[<span class="number">3</span>:<span class="number">0</span>]    addr,</span><br><span class="line">    <span class="keyword">input</span>  <span class="keyword">wire</span>         clock, we_, reset</span><br><span class="line">);</span><br><span class="line">    <span class="keyword">reg</span>[<span class="number">63</span>:<span class="number">0</span>]   regfile[<span class="number">14</span>:<span class="number">0</span>];</span><br><span class="line">    <span class="keyword">assign</span>  data_out</span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure>
<p>CMOS管:N管和P管，栅极，源极和漏极。<br>寄存器，触发器和锁存器</p>
<p>verilog的三种语句：</p>
<ol>
<li>assign,组合逻辑</li>
<li>always@(posedge clock),时序逻辑</li>
<li>module，模块调用语句。</li>
</ol>
<h1 id="指令系统的结构"><a href="#指令系统的结构" class="headerlink" title="指令系统的结构"></a>指令系统的结构</h1><p>状态单元、指令集、编程规范。  </p>
<h2 id="1-程序员的可见状态"><a href="#1-程序员的可见状态" class="headerlink" title="1. 程序员的可见状态"></a>1. 程序员的可见状态</h2><p>包括了：</p>
<h3 id="1-15个寄存器"><a href="#1-15个寄存器" class="headerlink" title="1. 15个寄存器"></a>1. 15个寄存器</h3><p>%rax %rsp %r8  %r12<br>%rcx %rbp %r9  %r13<br>%rdx %rsi %r10 %r14<br>%rbx %rdi %r11  </p>
<h3 id="2-三个条件码"><a href="#2-三个条件码" class="headerlink" title="2. 三个条件码"></a>2. 三个条件码</h3><div class="table-container">
<table>
<thead>
<tr>
<th>ZF</th>
<th>SF</th>
<th>OF</th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
</tr>
</tbody>
</table>
</div>
<h3 id="其他组件"><a href="#其他组件" class="headerlink" title="其他组件"></a>其他组件</h3><ol>
<li>程序计数器(<strong>PC</strong>)：存放指令地址</li>
<li>状态码(<strong>stat</strong>)</li>
<li>内存(<strong>memory</strong>)</li>
</ol>
<h2 id="movq指令"><a href="#movq指令" class="headerlink" title="movq指令"></a>movq指令</h2><p>从源操作数向目的操作数复制数据。</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>指令名称</th>
<th>源操作数</th>
<th>目的操作数</th>
</tr>
</thead>
<tbody>
<tr>
<td>rrmovq</td>
<td>register</td>
<td>register</td>
</tr>
<tr>
<td>irmovq</td>
<td>immediate</td>
<td>register</td>
</tr>
<tr>
<td>rmmovq</td>
<td>register</td>
<td>memory</td>
</tr>
<tr>
<td>mrmovq</td>
<td>memory</td>
<td>register</td>
</tr>
</tbody>
</table>
</div>
<h3 id="指令的组成"><a href="#指令的组成" class="headerlink" title="指令的组成"></a>指令的组成</h3><p>由4个字节组成。<br>高4位——指令类型<br>低4位——功能部分，置0<br>如果操作数中含有寄存器，则：<br>附加寄存器指示符字节。</p>
<h3 id="寄存器的编码"><a href="#寄存器的编码" class="headerlink" title="寄存器的编码"></a>寄存器的编码</h3><div class="table-container">
<table>
<thead>
<tr>
<th>寄存器命名</th>
<th>编号</th>
</tr>
</thead>
<tbody>
<tr>
<td>%rax</td>
<td>0</td>
</tr>
<tr>
<td>…</td>
<td>…</td>
</tr>
<tr>
<td>%rdi</td>
<td>7</td>
</tr>
<tr>
<td>…</td>
<td>…</td>
</tr>
<tr>
<td>%r13</td>
<td>0xD</td>
</tr>
<tr>
<td>%r14</td>
<td>0xE</td>
</tr>
<tr>
<td><none></td>
<td>0xF</td>
</tr>
</tbody>
</table>
</div>
<p>当操作数不是寄存器的时候，便可以用0xf进行填充。</p>
<h2 id="j指令——跳转指令"><a href="#j指令——跳转指令" class="headerlink" title="j指令——跳转指令"></a>j指令——跳转指令</h2><p>通过条件码的组合来判断是否进行跳转，操作数是跳转到的代码地址。</p>
<h2 id="cmov指令——条件传送指令"><a href="#cmov指令——条件传送指令" class="headerlink" title="cmov指令——条件传送指令"></a>cmov指令——条件传送指令</h2><p>条件码满足条件时，才会将源操作数传输到目的操作数中。</p>
<h2 id="halt指令"><a href="#halt指令" class="headerlink" title="halt指令"></a>halt指令</h2><p>停止指令。：：00</p>
<h2 id="nop指令"><a href="#nop指令" class="headerlink" title="nop指令"></a>nop指令</h2><p>空操作。：10</p>
<h2 id="call和ret"><a href="#call和ret" class="headerlink" title="call和ret"></a>call和ret</h2><p>调用函数和返回函数。<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">call dest ：80 dest</span><br><span class="line">ret: 90</span><br></pre></td></tr></table></figure></p>
<h2 id="push和pop"><a href="#push和pop" class="headerlink" title="push和pop"></a>push和pop</h2><p>实现数据的入栈和出栈操作。<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pushq rA: A0 rA F</span><br><span class="line">popq rA: B0 rA F</span><br></pre></td></tr></table></figure></p>
<h2 id="汇编语言转变为指令集的用例"><a href="#汇编语言转变为指令集的用例" class="headerlink" title="汇编语言转变为指令集的用例"></a>汇编语言转变为指令集的用例</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rmmovq %rsp 0x123456789abcd(%rdx)</span><br></pre></td></tr></table></figure>
<p>转变为处理器指令即为：</p>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">40</span> <span class="number">42</span> cd ab <span class="number">89</span> <span class="number">67</span> <span class="number">45</span> <span class="number">23</span> <span class="number">01</span> <span class="number">00</span></span><br></pre></td></tr></table></figure>
<p>在这里：<br>4：指令类型，movq指令。       0：功能部分，置0.<br>42：%rsp和%rdx的编码,分别是4和2.<br>这样总共占据了16位。<br>偏移量:</p>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">12</span> <span class="number">34</span> <span class="number">56</span> <span class="number">78</span> 9a bc d     </span><br></pre></td></tr></table></figure>
<p>不足8字节，需要进行补齐。那么则是：</p>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">00</span> <span class="number">01</span> <span class="number">23</span> <span class="number">45</span> <span class="number">67</span> <span class="number">89</span> ab cd </span><br></pre></td></tr></table></figure>
<p>在小端法存储系统中，最低有效字节数(cd)应该放在最前面，所以应当进行反向填充，则为：</p>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cd ab <span class="number">89</span> <span class="number">67</span> <span class="number">45</span> <span class="number">23</span> <span class="number">01</span> <span class="number">00</span></span><br></pre></td></tr></table></figure>
<p>合起来便是：</p>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">40</span> <span class="number">42</span> cd ab <span class="number">89</span> <span class="number">67</span> <span class="number">45</span> <span class="number">23</span> <span class="number">01</span> <span class="number">00</span></span><br></pre></td></tr></table></figure>
<h2 id="程序的状态码"><a href="#程序的状态码" class="headerlink" title="程序的状态码"></a>程序的状态码</h2><div class="table-container">
<table>
<thead>
<tr>
<th>值</th>
<th>命名</th>
<th>释义</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>AOK</td>
<td>正常执行</td>
</tr>
<tr>
<td>2</td>
<td>HLT</td>
<td>处理器执行了一条停止指令</td>
</tr>
<tr>
<td>3</td>
<td>ADR</td>
<td>程序试图从非法地址读写数据</td>
</tr>
<tr>
<td>4</td>
<td>INS</td>
<td>程序遇到了非法指令。</td>
</tr>
</tbody>
</table>
</div>
<p>处理器遇到异常时，一般会进行异常处理程序。</p>
<h2 id="缓冲区溢出"><a href="#缓冲区溢出" class="headerlink" title="缓冲区溢出"></a>缓冲区溢出</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">echo</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">char</span> buf[<span class="number">8</span>];</span><br><span class="line">    <span class="built_in">gets</span>(buf);</span><br><span class="line">    <span class="built_in">puts</span>(buf);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>以上的gets函数无法确定目标字符串的长度，可能会导致缓冲区溢出。</p>
<p>对抗缓冲区溢出攻击：</p>
<ol>
<li><strong>栈的随机化</strong>——地址空间布局随机化(ASLR)</li>
<li><strong>破坏检测</strong> 在缓冲区和保护地址之间安插”金丝雀”值。当这个值发生了改变，那么可知栈遭受了攻击。</li>
<li><strong>限制可执行代码区域</strong>：指定可执行代码区域的部分。</li>
</ol>
<h2 id="结构体"><a href="#结构体" class="headerlink" title="结构体"></a>结构体</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">rec</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> i;</span><br><span class="line">    <span class="keyword">int</span> j;</span><br><span class="line">    <span class="keyword">int</span> a[<span class="number">2</span>];</span><br><span class="line">    <span class="keyword">int</span> *p;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>编译器会根据数据类型，对内存进行一些对齐操作。int 类变量的地址必须是4的倍数，因此编译器会对那些不足4字节的变量后面进行补全，保证后继的变量(int)会是4字节的。<br>例如：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">s1</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> i;</span><br><span class="line">    <span class="keyword">char</span> c;</span><br><span class="line">    <span class="keyword">int</span> j;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>char c的后面就需要补充三个字节，保证int j位置合理。或是改成以下的顺序：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">s1</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> i;</span><br><span class="line">    <span class="keyword">int</span> j;</span><br><span class="line">    <span class="keyword">char</span> c;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>此时char c后面就会补充3字节。因此</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in"><span class="keyword">sizeof</span></span>(s1) = <span class="number">12</span>;</span><br></pre></td></tr></table></figure>
<p>地址对其的原则：<strong>K字节的基本对象的地址应该是K的倍数</strong><br>联合体：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">union</span> <span class="title">U3</span>&#123;</span></span><br><span class="line">    <span class="keyword">char</span> c;</span><br><span class="line">    <span class="keyword">int</span> i[<span class="number">2</span>];</span><br><span class="line">    <span class="keyword">double</span> v;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>联合体中所有变量是共享<strong>一块内存</strong>的。其内存取决于以上所有变量最大者。<br>因此：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in"><span class="keyword">sizeof</span></span>(U3)=<span class="number">8</span>;</span><br></pre></td></tr></table></figure>
<p>因为联合体所有变量都是在一块内存上保存的，所以这些变量是不能同时出现的。因此它可以用来保存那些互斥的变量，以节省空间。<br>例如二叉树节点的声明：<br>利用结构体：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">node</span> <span class="title">treeNode</span>;</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span>&#123;</span></span><br><span class="line">    treeNode *left;</span><br><span class="line">    treeNode *right;</span><br><span class="line">    <span class="keyword">double</span> val[<span class="number">2</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>或者利用联合体：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">union</span> <span class="title">node</span> <span class="title">treeNode</span>;</span></span><br><span class="line"><span class="class"><span class="keyword">union</span> <span class="title">node</span>&#123;</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span>&#123;</span></span><br><span class="line">        treeNode *left;</span><br><span class="line">        treeNode *right;</span><br><span class="line">        <span class="keyword">double</span> val[<span class="number">2</span>];</span><br><span class="line">    &#125;internal;</span><br><span class="line">    <span class="keyword">double</span> val[<span class="number">2</span>];</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>因为在二叉树里，只可能存在是内部节点(同时存在左右子)或是叶节点(没有子节点)的情况,因此是internal 和 val[2]两个变量只能同时存在一个。<br>如何确定该节点是叶节点或内部节点？<br>添加一个标签nodetype;</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">typdef <span class="class"><span class="keyword">enum</span>&#123;</span><span class="keyword">int</span> leaf=<span class="number">1</span>;<span class="keyword">int</span> internal = <span class="number">0</span>&#125; nodeType;</span><br><span class="line">structe <span class="keyword">node_t</span>&#123;</span><br><span class="line">    nodeType type;</span><br><span class="line">    <span class="class"><span class="keyword">union</span> <span class="title">node</span> <span class="title">node</span>;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>联合体也可以用来访问不同数据类型的位模型。以一种类型来存储，以另外一种类型来访问。例如：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">union</span> <span class="title">twoType</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> integer;</span><br><span class="line">    <span class="keyword">char</span> character;</span><br><span class="line">&#125;</span><br><span class="line"> cout&lt;&lt;twoType.integer&lt;&lt;endl;<span class="comment">//以整数的形式输出</span></span><br><span class="line"> cout&lt;&lt;twoType.character&lt;&lt;endl;<span class="comment">//以字符的形式输出</span></span><br></pre></td></tr></table></figure>
<h1 id="过程"><a href="#过程" class="headerlink" title="过程"></a>过程</h1><p>一个过程所包含的三个机制：</p>
<ol>
<li>传递控制</li>
<li>传递数据</li>
<li>分配及释放内存</li>
</ol>
<h2 id="栈帧的概念"><a href="#栈帧的概念" class="headerlink" title="栈帧的概念"></a>栈帧的概念</h2><p>若函数的存储空间大于寄存器的存储空间，则会使用栈上的存储空间，这部分空间则是函数的栈帧。<br>P调用Q的过程：<br>较早的帧——P的帧——Q的帧<br>eg：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">multstore</span><span class="params">(<span class="keyword">long</span>, <span class="keyword">long</span>, <span class="keyword">long</span>*)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">long</span> d;</span><br><span class="line">    <span class="built_in">multstore</span>(<span class="number">2</span>,<span class="number">3</span>,&amp;d);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d&quot;</span>,d);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">long</span> <span class="title">mult2</span><span class="params">(<span class="keyword">long</span> a,<span class="keyword">long</span> b)</span></span>&#123;</span><br><span class="line">    <span class="keyword">long</span> s=a*b;</span><br><span class="line">    <span class="keyword">return</span> s;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">multstore</span><span class="params">(<span class="keyword">long</span> x,<span class="keyword">long</span> y,<span class="keyword">long</span> *dest)</span></span>&#123;</span><br><span class="line">    <span class="keyword">long</span> t=<span class="built_in">mult2</span>(x,y);</span><br><span class="line">    *dest = t;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>一部分对应的汇编语言：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;main&gt;:</span><br><span class="line">callq 741 &lt;multstore&gt;</span><br><span class="line">mov (%rsp), %rdx</span><br><span class="line"></span><br><span class="line">&lt;multstore&gt;:</span><br><span class="line">push %rbx</span><br><span class="line">mov %rdx,%rbx</span><br></pre></td></tr></table></figure>
<p>741是multstore的地址<br>调用的具体过程：</p>
<ol>
<li>将<multstore>第一条指令的地址存入指令寄存器%rip中</li>
<li>将返回地址(%rsp)压入栈%rsp当中</li>
<li><multstore>执行完成，返回地址从%rsp中被弹出，存入%rip中</li>
</ol>
<h2 id="参数传递的过程"><a href="#参数传递的过程" class="headerlink" title="参数传递的过程"></a>参数传递的过程</h2><p>如果一个函数的参数&gt;6，那么函数将由栈帧来存储。从第七个到最后一个参数都将存储到栈中。<br>参数1~6存储到以下的寄存器当中：</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>参数的字长</th>
<th>1</th>
<th>2</th>
<th>3</th>
<th>4</th>
<th>5</th>
<th>6</th>
</tr>
</thead>
<tbody>
<tr>
<td>64</td>
<td>%rdi</td>
<td>%rsi</td>
<td>%rdx</td>
<td>%rcx</td>
<td>%r8</td>
<td>%r9</td>
</tr>
<tr>
<td>32</td>
<td>%edi</td>
<td>%esi</td>
<td>%edx</td>
<td>%ecx</td>
<td>%r8d</td>
<td>&amp;r9d</td>
</tr>
<tr>
<td>16</td>
<td>%di</td>
<td>%si</td>
<td>%dx</td>
<td>%cx</td>
<td>%r8w</td>
<td>%r9w</td>
</tr>
<tr>
<td>8</td>
<td>%dil</td>
<td>%sil</td>
<td>%dl</td>
<td>%cl</td>
<td>%r8b</td>
<td>%r9b</td>
</tr>
</tbody>
</table>
</div>
<p>所有在栈帧中的参数所获得的空间都将是8的倍数。<br>地址运算符：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">caller：</span><br><span class="line">    subq $16,%rsp       //为栈帧分配16位空间</span><br></pre></td></tr></table></figure>
<p>寄存器被所有函数所共用。为了避免出现数据重复读写的问题，寄存器有一些属性。</p>
<ul>
<li>调用者保存</li>
<li>被调用者保存</li>
</ul>
<h1 id="数组的分配和访问"><a href="#数组的分配和访问" class="headerlink" title="数组的分配和访问"></a>数组的分配和访问</h1><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">E[i]&#123;</span><br><span class="line">    var Ei;</span><br><span class="line">    address &amp;E[i];</span><br><span class="line">&#125;</span><br><span class="line">E+<span class="number">2</span> = 首地址向后移动<span class="number">2</span>位的地址</span><br></pre></td></tr></table></figure>
<h2 id="嵌套数组-二位数组"><a href="#嵌套数组-二位数组" class="headerlink" title="嵌套数组/二位数组"></a>嵌套数组/二位数组</h2><p>二维数组在C里面行优先存储。<br>数组元素地址的计算方式：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> D[R][C];    <span class="comment">//R行C列的矩阵D</span></span><br><span class="line"><span class="keyword">int</span> *Xd = D;    <span class="comment">//D的存储类型</span></span><br><span class="line"><span class="keyword">int</span> L=<span class="built_in"><span class="keyword">sizeof</span></span>(<span class="keyword">int</span>);<span class="comment">//数据类型的字长</span></span><br><span class="line">&amp;D[i][j]=Xd+L*(C*i+j);</span><br></pre></td></tr></table></figure>
<h2 id="定长地址的优化"><a href="#定长地址的优化" class="headerlink" title="定长地址的优化"></a>定长地址的优化</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">salq $6, %rdx   //计算首行地址</span><br><span class="line">addq %rdx,%rdi</span><br><span class="line">leaq (%rsi,%rcx,4) ,%rcx</span><br><span class="line">leaq 1024(%rcx), %rsi</span><br><span class="line">movl $0, %eax</span><br></pre></td></tr></table></figure>
<p>变长数组的问题：<br>与一般的数组不同，在计算地址时，利用乘法指令计算n*i</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">imul %rdi, %rsi</span><br></pre></td></tr></table></figure>
<h1 id="程序的机器级解释"><a href="#程序的机器级解释" class="headerlink" title="程序的机器级解释"></a>程序的机器级解释</h1><ol>
<li>利用gcc进行编译<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//main.c</span></span><br><span class="line"><span class="comment">//mstore.c</span></span><br><span class="line">编译命令：linux&gt;gcc -og -o prog main.c mstore.c</span><br><span class="line">最终会生成prog.exe</span><br></pre></td></tr></table></figure>
c程序与汇编程序之间的关系：<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">long</span> <span class="title">mult2</span><span class="params">(<span class="keyword">long</span>,<span class="keyword">long</span>)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">long</span> <span class="title">mulstore</span><span class="params">(<span class="keyword">long</span> x, <span class="keyword">long</span> y, <span class="keyword">long</span> *dest)</span></span>&#123;</span><br><span class="line">    <span class="keyword">long</span> t = <span class="built_in">mult2</span>(x,y);</span><br><span class="line">    *dest = t;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
对应汇编程序：<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">multstore:</span><br><span class="line">    pushq %rbx</span><br><span class="line">    movq %rdx, %rbx</span><br><span class="line">    call mult2</span><br><span class="line">    movq %rax, (%rbx)</span><br><span class="line">    popq %rbx</span><br><span class="line">    ret</span><br></pre></td></tr></table></figure>
16个通用寄存器<br>调用者保存和被调运者保存<br>操作数的概念：<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">b,w,l,q,q,s,l</span><br><span class="line">1 2 4 8 8 4 8</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>八个寄存器：<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">%rax        //保存返回值</span><br><span class="line">%rbx</span><br><span class="line">%rcx</span><br><span class="line">%rdx        //传参</span><br><span class="line">%rsi</span><br><span class="line">%rdi</span><br><span class="line">%rbp</span><br><span class="line">%rsp        //保存程序栈的结束位置</span><br></pre></td></tr></table></figure><br>指令 = 操作码+操作数<br>操作数：</p>
<ul>
<li>立即数</li>
<li>寄存器</li>
<li>内存引用</li>
</ul>
<p>寄存器的部分表示:</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>64</th>
<th>32</th>
<th>16</th>
<th>8</th>
</tr>
</thead>
<tbody>
<tr>
<td>%rax</td>
<td>%eax</td>
<td>%ax</td>
<td>%al</td>
</tr>
</tbody>
</table>
</div>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">long</span> <span class="title">exchange</span><span class="params">(<span class="keyword">long</span> *xp,<span class="keyword">long</span> y)</span></span>&#123;</span><br><span class="line">    <span class="keyword">long</span> x = *xp;</span><br><span class="line">    *xp = y;</span><br><span class="line">    <span class="keyword">return</span> x;</span><br><span class="line">&#125;</span><br><span class="line">exchange:</span><br><span class="line">    xp in %rdi, y in %<span class="function">rsi</span></span><br><span class="line"><span class="function">    <span class="title">movq</span> <span class="params">(%rdi)</span> , %rax</span></span><br><span class="line"><span class="function">    movq %rsi , <span class="params">(%rdi)</span></span></span><br><span class="line"><span class="function">    ret</span></span><br></pre></td></tr></table></figure>
<p>disk-&gt;(shell)-&gt;memory</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mov mem, regs</span><br></pre></td></tr></table></figure>
<h1 id="数据的构成"><a href="#数据的构成" class="headerlink" title="数据的构成"></a>数据的构成</h1><p>符号数-最高位是符号位——利用补码<br>负数：最高位是1<br>正数：最高位是0 </p>
<p>无符号数和有符号数之间的转换:<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> w 字长</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> Tmax 最大可能的数组</span></span><br><span class="line"><span class="function"><span class="keyword">unsigned</span> <span class="keyword">short</span> <span class="title">T2U</span><span class="params">(<span class="keyword">short</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(x&lt;<span class="number">0</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> x+<span class="built_in">pow</span>(<span class="number">2</span>,w);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> x;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">short</span> <span class="title">U2T</span><span class="params">(unsgined <span class="keyword">short</span> u)</span></span>&#123;</span><br><span class="line">    <span class="keyword">unsigned</span> TMax;</span><br><span class="line">    <span class="keyword">if</span>(u&lt;=Tmax)&#123;</span><br><span class="line">        <span class="keyword">return</span> u;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> u-<span class="built_in">pow</span>(<span class="number">2</span>,w);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>数据格式的转换：<br>eg:unsigned char =&gt;unsgined short<br>直接在前面补零即可。<br>eg:char =&gt; short<br>正数补零，负数补1。<br>eg:int =&gt;  short<br>直接截断，或者取模。        </p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://alberteuler.github.io/not_advanced_ins.github.io/2021/06/27/hash/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/not_advanced_ins.github.io/images/avatar.jpg">
      <meta itemprop="name" content="Albert -W">
      <meta itemprop="description" content="更不更新看心情">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="不先进摸鱼研究所">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/not_advanced_ins.github.io/2021/06/27/hash/" class="post-title-link" itemprop="url">使用hashtable</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2021-06-27 22:11:48 / Modified: 22:12:55" itemprop="dateCreated datePublished" datetime="2021-06-27T22:11:48+08:00">2021-06-27</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/not_advanced_ins.github.io/categories/%E7%AE%97%E6%B3%95/" itemprop="url" rel="index"><span itemprop="name">算法</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="设计hashmap"><a href="#设计hashmap" class="headerlink" title="设计hashmap"></a>设计hashmap</h1><h2 id="hashset"><a href="#hashset" class="headerlink" title="hashset"></a>hashset</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAX_LEN 100000          <span class="comment">// the amount of buckets</span></span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyHashSet</span> &#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    vector&lt;<span class="keyword">int</span>&gt; set[MAX_LEN];   <span class="comment">// hash set implemented by array</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">/** Returns the corresponding bucket index. */</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">getIndex</span><span class="params">(<span class="keyword">int</span> key)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> key % MAX_LEN;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/** Search the key in a specific bucket. Returns -1 if the key does not existed. */</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">getPos</span><span class="params">(<span class="keyword">int</span> key, <span class="keyword">int</span> index)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// Each bucket contains a list. Iterate all the elements in the bucket to find the target key.</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; set[index].<span class="built_in">size</span>(); ++i) &#123;</span><br><span class="line">            <span class="keyword">if</span> (set[index][i] == key) &#123;</span><br><span class="line">                <span class="keyword">return</span> i;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">/** Initialize your data structure here. */</span></span><br><span class="line">    <span class="built_in">MyHashSet</span>() &#123;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> key)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> index = <span class="built_in">getIndex</span>(key);</span><br><span class="line">        <span class="keyword">int</span> pos = <span class="built_in">getPos</span>(key, index);</span><br><span class="line">        <span class="keyword">if</span> (pos &lt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="comment">// Add new key if key does not exist.</span></span><br><span class="line">            set[index].<span class="built_in">push_back</span>(key);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">remove</span><span class="params">(<span class="keyword">int</span> key)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> index = <span class="built_in">getIndex</span>(key);</span><br><span class="line">        <span class="keyword">int</span> pos = <span class="built_in">getPos</span>(key, index);</span><br><span class="line">        <span class="keyword">if</span> (pos &gt;= <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="comment">// Remove the key if key exists.</span></span><br><span class="line">            set[index].<span class="built_in">erase</span>(set[index].<span class="built_in">begin</span>() + pos);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/** Returns true if this set did not already contain the specified element */</span></span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">contains</span><span class="params">(<span class="keyword">int</span> key)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> index = <span class="built_in">getIndex</span>(key);</span><br><span class="line">        <span class="keyword">int</span> pos = <span class="built_in">getPos</span>(key, index);</span><br><span class="line">        <span class="keyword">return</span> pos &gt;= <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Your MyHashSet object will be instantiated and called as such:</span></span><br><span class="line"><span class="comment"> * MyHashSet obj = new MyHashSet();</span></span><br><span class="line"><span class="comment"> * obj.add(key);</span></span><br><span class="line"><span class="comment"> * obj.remove(key);</span></span><br><span class="line"><span class="comment"> * bool param_3 = obj.contains(key);</span></span><br><span class="line"><span class="comment"> */</span></span><br></pre></td></tr></table></figure>
<h2 id="hashmap"><a href="#hashmap" class="headerlink" title="hashmap"></a>hashmap</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAX_LEN 100000            <span class="comment">// the amount of buckets</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyHashMap</span> &#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    vector&lt;pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt;&gt; map[MAX_LEN];       <span class="comment">// hash map implemented by array</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">/** Returns the corresponding bucket index. */</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">getIndex</span><span class="params">(<span class="keyword">int</span> key)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> key % MAX_LEN;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/** Search the key in a specific bucket. Returns -1 if the key does not existed. */</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">getPos</span><span class="params">(<span class="keyword">int</span> key, <span class="keyword">int</span> index)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// Each bucket contains a vector. Iterate all the elements in the bucket to find the target key.</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; map[index].<span class="built_in">size</span>(); ++i) &#123;</span><br><span class="line">            <span class="keyword">if</span> (map[index][i].first == key) &#123;</span><br><span class="line">                <span class="keyword">return</span> i;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">/** Initialize your data structure here. */</span></span><br><span class="line">    <span class="built_in">MyHashMap</span>() &#123;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/** value will always be positive. */</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">put</span><span class="params">(<span class="keyword">int</span> key, <span class="keyword">int</span> value)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> index = <span class="built_in">getIndex</span>(key);</span><br><span class="line">        <span class="keyword">int</span> pos = <span class="built_in">getPos</span>(key, index);</span><br><span class="line">        <span class="keyword">if</span> (pos &lt; <span class="number">0</span>) &#123;</span><br><span class="line">            map[index].<span class="built_in">push_back</span>(<span class="built_in">make_pair</span>(key, value));</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            map[index][pos].second = value;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/** Returns the value to which the specified key is mapped, or -1 if this map contains no mapping for the key */</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">get</span><span class="params">(<span class="keyword">int</span> key)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> index = <span class="built_in">getIndex</span>(key);</span><br><span class="line">        <span class="keyword">int</span> pos = <span class="built_in">getPos</span>(key, index);</span><br><span class="line">        <span class="keyword">if</span> (pos &lt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> map[index][pos].second;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/** Removes the mapping of the specified value key if this map contains a mapping for the key */</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">remove</span><span class="params">(<span class="keyword">int</span> key)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> index = <span class="built_in">getIndex</span>(key);</span><br><span class="line">        <span class="keyword">int</span> pos = <span class="built_in">getPos</span>(key, index);</span><br><span class="line">        <span class="keyword">if</span> (pos &gt;= <span class="number">0</span>) &#123;</span><br><span class="line">            map[index].<span class="built_in">erase</span>(map[index].<span class="built_in">begin</span>() + pos);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Your MyHashMap object will be instantiated and called as such:</span></span><br><span class="line"><span class="comment"> * MyHashMap obj = new MyHashMap();</span></span><br><span class="line"><span class="comment"> * obj.put(key,value);</span></span><br><span class="line"><span class="comment"> * int param_2 = obj.get(key);</span></span><br><span class="line"><span class="comment"> * obj.remove(key);</span></span><br><span class="line"><span class="comment"> */</span></span><br></pre></td></tr></table></figure>
<h1 id="hashset计算"><a href="#hashset计算" class="headerlink" title="hashset计算"></a>hashset计算</h1><h2 id="基本操作"><a href="#基本操作" class="headerlink" title="基本操作"></a>基本操作</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;unordered_set&gt;</span>                <span class="comment">// 0. include the library</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 1. initialize a hash set</span></span><br><span class="line">    unordered_set&lt;<span class="keyword">int</span>&gt; hashset;   </span><br><span class="line">    <span class="comment">// 2. insert a new key</span></span><br><span class="line">    hashset.<span class="built_in">insert</span>(<span class="number">3</span>);</span><br><span class="line">    hashset.<span class="built_in">insert</span>(<span class="number">2</span>);</span><br><span class="line">    hashset.<span class="built_in">insert</span>(<span class="number">1</span>);</span><br><span class="line">    <span class="comment">// 3. delete a key</span></span><br><span class="line">    hashset.<span class="built_in">erase</span>(<span class="number">2</span>);</span><br><span class="line">    <span class="comment">// 4. check if the key is in the hash set</span></span><br><span class="line">    <span class="keyword">if</span> (hashset.<span class="built_in">count</span>(<span class="number">2</span>) &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;Key 2 is not in the hash set.&quot;</span> &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 5. get the size of the hash set</span></span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;The size of hash set is: &quot;</span> &lt;&lt; hashset.<span class="built_in">size</span>() &lt;&lt; endl; </span><br><span class="line">    <span class="comment">// 6. iterate the hash set</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> it = hashset.<span class="built_in">begin</span>(); it != hashset.<span class="built_in">end</span>(); ++it) &#123;</span><br><span class="line">        cout &lt;&lt; (*it) &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;are in the hash set.&quot;</span> &lt;&lt; endl;</span><br><span class="line">    <span class="comment">// 7. clear the hash set</span></span><br><span class="line">    hashset.<span class="built_in">clear</span>();</span><br><span class="line">    <span class="comment">// 8. check if the hash set is empty</span></span><br><span class="line">    <span class="keyword">if</span> (hashset.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;hash set is empty now!&quot;</span> &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="查重"><a href="#查重" class="headerlink" title="查重"></a>查重</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * Template for using hash set to find duplicates.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">findDuplicates</span><span class="params">(vector&lt;Type&gt;&amp; keys)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// Replace Type with actual type of your key</span></span><br><span class="line">    unordered_set&lt;Type&gt; hashset;</span><br><span class="line">    <span class="keyword">for</span> (Type key : keys) &#123;</span><br><span class="line">        <span class="keyword">if</span> (hashset.<span class="built_in">count</span>(key) &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        hashset.<span class="built_in">insert</span>(key);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="hashmap的映射计算"><a href="#hashmap的映射计算" class="headerlink" title="hashmap的映射计算"></a>hashmap的映射计算</h1><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;unordered_map&gt;</span>                <span class="comment">// 0. include the library</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 1. initialize a hash map</span></span><br><span class="line">    unordered_map&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; hashmap;</span><br><span class="line">    <span class="comment">// 2. insert a new (key, value) pair</span></span><br><span class="line">    hashmap.<span class="built_in">insert</span>(<span class="built_in">make_pair</span>(<span class="number">0</span>, <span class="number">0</span>));</span><br><span class="line">    hashmap.<span class="built_in">insert</span>(<span class="built_in">make_pair</span>(<span class="number">2</span>, <span class="number">3</span>));</span><br><span class="line">    <span class="comment">// 3. insert a new (key, value) pair or update the value of existed key</span></span><br><span class="line">    hashmap[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    hashmap[<span class="number">1</span>] = <span class="number">2</span>;</span><br><span class="line">    <span class="comment">// 4. get the value of a specific key</span></span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;The value of key 1 is: &quot;</span> &lt;&lt; hashmap[<span class="number">1</span>] &lt;&lt; endl;</span><br><span class="line">    <span class="comment">// 5. delete a key</span></span><br><span class="line">    hashmap.<span class="built_in">erase</span>(<span class="number">2</span>);</span><br><span class="line">    <span class="comment">// 6. check if a key is in the hash map</span></span><br><span class="line">    <span class="keyword">if</span> (hashmap.<span class="built_in">count</span>(<span class="number">2</span>) &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;Key 2 is not in the hash map.&quot;</span> &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 7. get the size of the hash map</span></span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;the size of hash map is: &quot;</span> &lt;&lt; hashmap.<span class="built_in">size</span>() &lt;&lt; endl; </span><br><span class="line">    <span class="comment">// 8. iterate the hash map</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> it = hashmap.<span class="built_in">begin</span>(); it != hashmap.<span class="built_in">end</span>(); ++it) &#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;(&quot;</span> &lt;&lt; it-&gt;first &lt;&lt; <span class="string">&quot;,&quot;</span> &lt;&lt; it-&gt;second &lt;&lt; <span class="string">&quot;) &quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;are in the hash map.&quot;</span> &lt;&lt; endl;</span><br><span class="line">    <span class="comment">// 9. clear the hash map</span></span><br><span class="line">    hashmap.<span class="built_in">clear</span>();</span><br><span class="line">    <span class="comment">// 10. check if the hash map is empty</span></span><br><span class="line">    <span class="keyword">if</span> (hashmap.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;hash map is empty now!&quot;</span> &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="提供更多信息"><a href="#提供更多信息" class="headerlink" title="提供更多信息"></a>提供更多信息</h1><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * Template for using hash map to find duplicates.</span></span><br><span class="line"><span class="comment"> * Replace ReturnType with the actual type of your return value.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function">ReturnType <span class="title">aggregateByKey_hashmap</span><span class="params">(vector&lt;Type&gt;&amp; keys)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// Replace Type and InfoType with actual type of your key and value</span></span><br><span class="line">    unordered_map&lt;Type, InfoType&gt; hashtable;</span><br><span class="line">    <span class="keyword">for</span> (Type key : keys) &#123;</span><br><span class="line">        <span class="keyword">if</span> (hashmap.<span class="built_in">count</span>(key) &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (hashmap[key] satisfies the requirement) &#123;</span><br><span class="line">                <span class="keyword">return</span> needed_information;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// Value can be any information you needed (e.g. index)</span></span><br><span class="line">        hashmap[key] = value;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> needed_information;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="按键聚合"><a href="#按键聚合" class="headerlink" title="按键聚合"></a>按键聚合</h1><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * Template for using hash map to find duplicates.</span></span><br><span class="line"><span class="comment"> * Replace ReturnType with the actual type of your return value.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function">ReturnType <span class="title">aggregateByKey_hashmap</span><span class="params">(vector&lt;Type&gt;&amp; keys)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// Replace Type and InfoType with actual type of your key and value</span></span><br><span class="line">    unordered_map&lt;Type, InfoType&gt; hashtable;</span><br><span class="line">    <span class="keyword">for</span> (Type key : keys) &#123;</span><br><span class="line">        <span class="keyword">if</span> (hashmap.<span class="built_in">count</span>(key) &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            update hashmap[key];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// Value can be any information you needed (e.g. index)</span></span><br><span class="line">        hashmap[key] = value;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> needed_information;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://alberteuler.github.io/not_advanced_ins.github.io/2021/06/27/atoi/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/not_advanced_ins.github.io/images/avatar.jpg">
      <meta itemprop="name" content="Albert -W">
      <meta itemprop="description" content="更不更新看心情">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="不先进摸鱼研究所">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/not_advanced_ins.github.io/2021/06/27/atoi/" class="post-title-link" itemprop="url">实现一个atoi函数</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2021-06-27 22:05:55 / Modified: 22:09:42" itemprop="dateCreated datePublished" datetime="2021-06-27T22:05:55+08:00">2021-06-27</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/not_advanced_ins.github.io/categories/%E7%AE%97%E6%B3%95/" itemprop="url" rel="index"><span itemprop="name">算法</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="题目要求"><a href="#题目要求" class="headerlink" title="题目要求"></a>题目要求</h2><p>实现一个<code>myAtoi(string s)</code>函数，使其将字符串转换成32位有符号证书<br>算法实现如下:</p>
<ul>
<li>读入字符串并丢弃无用的前导空格</li>
<li>检查下一个字符（假设还未到字符末尾）为正还是负号，读取该字符（如果有）。 确定最终结果是负数还是正数。 如果两者都不存在，则假定结果为正。</li>
<li>读入下一个字符，直到到达下一个非数字字符或到达输入的结尾。字符串的其余部分将被忽略。</li>
<li>将前面步骤读入的这些数字转换为整数（即，”123” -&gt; 123， “0032” -&gt; 32）。如果没有读入数字，则整数为 0 。必要时更改符号（从步骤 2 开始）。</li>
<li>如果整数数超过 32 位有符号整数范围 [<code>$−2^&#123;31&#125;$</code>, <code>$2^&#123;31&#125;− 1$</code>] ，需要截断这个整数，使其保持在这个范围内。具体来说，小于 <code>$−2^&#123;31&#125;$</code> 的整数应该被固定为 <code>$−2^&#123;31&#125;$</code>，大于 <code>$2^&#123;31&#125;− 1$</code>的整数应该被固定为 <code>$2^&#123;31&#125;− 1$</code> 。<br>返回整数作为最终结果。</li>
</ul>
<h2 id="算法解析"><a href="#算法解析" class="headerlink" title="算法解析"></a>算法解析</h2><h3 id="整体思路："><a href="#整体思路：" class="headerlink" title="整体思路："></a>整体思路：</h3><p>根据题意，有以下四种字符需要考虑：</p>
<ol>
<li>首部空格： 删除之即可；</li>
<li>符号位： 三种情况，即 ‘’++’’ , ‘’-−’’ , ‘’无符号” ；新建一个变量保存符号位，返回前判断正负即可；</li>
<li>非数字字符： 遇到首个非数字的字符时，应立即返回；</li>
<li>数字字符：<br> 1.字符转数字： “此数字的 ASCII 码” 与 “ 00 的 ASCII 码” 相减即可；          <ol>
<li>数字拼接： 若从左向右遍历数字，设当前位字符为 cc ，当前位数字为 xx ，数字结果为 resres ，则数字拼接公式为：</li>
</ol>
</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$$</span><br><span class="line">res = 10 \times res + x \\ x = ascii(c) - ascii(&#x27;0&#x27;)</span><br><span class="line">res=10×res+x</span><br><span class="line">x=ascii(c)−ascii( ′0 ′)</span><br><span class="line">$$</span><br></pre></td></tr></table></figure>
<h3 id="数字越界处理："><a href="#数字越界处理：" class="headerlink" title="数字越界处理："></a>数字越界处理：</h3><p>题目要求返回的数值范围应在<code>$[-2^&#123;31&#125;, 2^&#123;31&#125; - 1]$</code> ，因此需要考虑数字越界问题。而由于题目指出 环境只能存储 32 位大小的有符号整数 ，因此判断数字越界时，要始终保持 resres 在 int 类型的取值范围内。</p>
<p>在每轮数字拼接前，判断 resres 在此轮拼接后是否超过 21474836472147483647 ，若超过则加上符号位直接返回。<br>设数字拼接边界<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bndry = 2147483647 // 10 = =214748364 </span><br></pre></td></tr></table></figure><br>，则以下两种情况越界：<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">\begin&#123;cases&#125; res &gt; bndry &amp; 情况一：执行拼接 10 \times res \geq 2147483650 越界 \\ res = bndry, x &gt; 7 &amp; 情况二：拼接后是 2147483648 或 2147483649 越界 \\ \end&#123;cases&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line">    <span class="keyword">int</span> max = <span class="built_in">pow</span>(<span class="number">2</span>,<span class="number">31</span>)<span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">int</span> min = -<span class="built_in">pow</span>(<span class="number">2</span>,<span class="number">31</span>);</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">myAtoi</span><span class="params">(string s)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> symbol = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">int</span> i=<span class="number">0</span>;</span><br><span class="line">        <span class="comment">//首先略过前导空格</span></span><br><span class="line">        <span class="keyword">while</span>(s[i]==<span class="string">&#x27; &#x27;</span>)i++;</span><br><span class="line">        <span class="keyword">if</span>(s[i] ==<span class="string">&#x27;-&#x27;</span>||s[i]==<span class="string">&#x27;+&#x27;</span>)&#123;</span><br><span class="line">            symbol = (s[i]==<span class="string">&#x27;-&#x27;</span>)?<span class="number">-1</span>:<span class="number">1</span>;</span><br><span class="line">            i++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">long</span> <span class="keyword">int</span> number = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span>(s[i]&gt;=<span class="string">&#x27;0&#x27;</span>&amp;&amp;s[i]&lt;=<span class="string">&#x27;9&#x27;</span>)&#123;</span><br><span class="line">            number *=<span class="number">10</span>;</span><br><span class="line">            number += (s[i]-<span class="string">&#x27;0&#x27;</span>);</span><br><span class="line">            i++;</span><br><span class="line">            <span class="keyword">if</span>(number*symbol&gt;=max)&#123;</span><br><span class="line">                <span class="keyword">return</span> max;</span><br><span class="line">            &#125;<span class="keyword">else</span> <span class="keyword">if</span>(number*symbol&lt;=min)&#123;</span><br><span class="line">                <span class="keyword">return</span> min;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> result = number * symbol;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://alberteuler.github.io/not_advanced_ins.github.io/2021/06/27/process-note-1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/not_advanced_ins.github.io/images/avatar.jpg">
      <meta itemprop="name" content="Albert -W">
      <meta itemprop="description" content="更不更新看心情">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="不先进摸鱼研究所">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/not_advanced_ins.github.io/2021/06/27/process-note-1/" class="post-title-link" itemprop="url">进程和线程的基本概念</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2021-06-27 22:03:11 / Modified: 22:05:27" itemprop="dateCreated datePublished" datetime="2021-06-27T22:03:11+08:00">2021-06-27</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/not_advanced_ins.github.io/categories/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/" itemprop="url" rel="index"><span itemprop="name">操作系统</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="中断和异常"><a href="#中断和异常" class="headerlink" title="中断和异常"></a>中断和异常</h1><h2 id="中断机制的来由"><a href="#中断机制的来由" class="headerlink" title="中断机制的来由"></a>中断机制的来由</h2><p>实现了多道程序的并发执行功能。发生中断就一维这需要操作系统的介入，并开展管理工作        </p>
<h2 id="中断的概念和作用"><a href="#中断的概念和作用" class="headerlink" title="中断的概念和作用"></a>中断的概念和作用</h2><ol>
<li>中断发生：CPU进入核心态；</li>
<li>中断发生后：运行的进程暂停运行，并由操作系统内合对中断进行处理。</li>
</ol>
<h2 id="中断的分类"><a href="#中断的分类" class="headerlink" title="中断的分类"></a>中断的分类</h2><ol>
<li>内中断<ol>
<li>自愿中断——trap，故意的</li>
<li>强迫中断<br> 1.硬件故障——fault，可修复<ol>
<li>软件中断——abort,无法回复</li>
</ol>
</li>
</ol>
</li>
<li>外中断<ol>
<li>外设请求</li>
<li>人工干预<br>判断标准：中断信号来自于CPU的内部还是外部？</li>
</ol>
</li>
</ol>
<h2 id="外部中断的处理过程"><a href="#外部中断的处理过程" class="headerlink" title="外部中断的处理过程"></a>外部中断的处理过程</h2><ol>
<li>检测外部中断信号</li>
<li>保护CPU环境</li>
<li>转入相应的中断处理程序</li>
</ol>
<h1 id="系统调用"><a href="#系统调用" class="headerlink" title="系统调用"></a>系统调用</h1><h2 id="系统调用的概念和作用"><a href="#系统调用的概念和作用" class="headerlink" title="系统调用的概念和作用"></a>系统调用的概念和作用</h2><p>操作系统作为用户和计算机硬件之间的接口，包括了命令接口和程序接口。其中程序接口便是由一组系统调用构成。</p>
<ol>
<li>命令接口——允许用户直接使用</li>
<li>程序接口——允许用户通过程序间接使用。</li>
</ol>
<p>系统调用的作用：应用程序透过系统调用请求操作系统的服务。凡是与资源有关的操作，都必须透过系统调用的方式向系统提出服务请求，并由操作系统代为完成。这样保证了系统的稳定性和安全性。</p>
<p>系统调用的相关处理需要在<strong>核心态</strong>下才可以完成。</p>
<h2 id="系统调用和库函数的区别："><a href="#系统调用和库函数的区别：" class="headerlink" title="系统调用和库函数的区别："></a>系统调用和库函数的区别：</h2><p>一部分库函数，例如fopen等函数，涉及到系统资源的调度，需要涉及到系统调用。<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mov </span><br><span class="line">int </span><br></pre></td></tr></table></figure></p>
<p>传入系统调用参数——执行陷入指令（用户态）——执行系统调用相应的服务程序（核心态）——返回用户程序</p>
<ol>
<li>陷入指令在用户态执行，执行后会立即引发一个内终端，从而使CPU进入核心态。</li>
<li>发出系统调用的请求使在永辉太处理</li>
</ol>
<h1 id="进程和线程的基本概念"><a href="#进程和线程的基本概念" class="headerlink" title="进程和线程的基本概念"></a>进程和线程的基本概念</h1><p>一道程序在内存上包含两个内容：</p>
<ol>
<li>程序段</li>
<li>数据段</li>
</ol>
<h2 id="定义："><a href="#定义：" class="headerlink" title="定义："></a>定义：</h2><p>程序段、数据段和PCB三个部分组成了一个进程的实体。PCB是进程存在的为的标志。</p>
<ol>
<li>进程是程序的执行过程</li>
<li>进程是一个程序及其数据在处理机上顺序执行时错发生的活动。</li>
<li>进程市具有独立功能的程序在数据集合上缩运行的过程。</li>
</ol>
<p>引入进程实体的概念后，可以把进程定义为：<br>进程是进程实体的运行过程，是系统进行<strong>资源分配</strong>和<strong>调度</strong>的一个独立单位。</p>
<p>进程实体是静态的，进程是动态的。</p>
<ol>
<li>程序段：存放程序的代码本身，包括程序的命令</li>
<li>数据段：程序产生的各种运算数据。</li>
<li>PCB：操作系统的管理手段，PCB包括了管理所需要的信息。</li>
</ol>
<h2 id="PCB的组成："><a href="#PCB的组成：" class="headerlink" title="PCB的组成："></a>PCB的组成：</h2><ol>
<li>进程描述信息<ol>
<li>进程标识符</li>
<li>用户标识符</li>
</ol>
</li>
<li>进程的控制和管理信息<ol>
<li>进程当前状态</li>
<li>进程的优先级</li>
</ol>
</li>
<li>资源分配清单<ol>
<li>程序段指针</li>
<li>数据段指针</li>
<li>键盘</li>
<li>鼠标</li>
</ol>
</li>
<li>处理及的相关信息<ol>
<li>各种寄存器的值</li>
</ol>
</li>
</ol>
<h2 id="进程的组织方式："><a href="#进程的组织方式：" class="headerlink" title="进程的组织方式："></a>进程的组织方式：</h2><ol>
<li>链接方式<ol>
<li>执行指针</li>
<li>就绪队列指针</li>
<li>阻塞队列指针</li>
</ol>
</li>
<li>索引方式</li>
</ol>
<h2 id="进程的特征："><a href="#进程的特征：" class="headerlink" title="进程的特征："></a>进程的特征：</h2><ol>
<li>动态性</li>
<li>并发性</li>
<li>独立性——独立运行，独立获得资源，独立接受调度</li>
<li>异步性——各个进程按照格子独立和不可预知的速度向前推进，可能会导致其不确定性。</li>
<li>结构性——每个进程都有一个PCB</li>
</ol>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://alberteuler.github.io/not_advanced_ins.github.io/2021/06/27/file-note-2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/not_advanced_ins.github.io/images/avatar.jpg">
      <meta itemprop="name" content="Albert -W">
      <meta itemprop="description" content="更不更新看心情">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="不先进摸鱼研究所">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/not_advanced_ins.github.io/2021/06/27/file-note-2/" class="post-title-link" itemprop="url">磁盘系统</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2021-06-27 22:01:14 / Modified: 22:01:58" itemprop="dateCreated datePublished" datetime="2021-06-27T22:01:14+08:00">2021-06-27</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/not_advanced_ins.github.io/categories/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/" itemprop="url" rel="index"><span itemprop="name">操作系统</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://alberteuler.github.io/not_advanced_ins.github.io/2021/06/27/memeory-note-3/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/not_advanced_ins.github.io/images/avatar.jpg">
      <meta itemprop="name" content="Albert -W">
      <meta itemprop="description" content="更不更新看心情">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="不先进摸鱼研究所">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/not_advanced_ins.github.io/2021/06/27/memeory-note-3/" class="post-title-link" itemprop="url">虚拟内存技术</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2021-06-27 21:58:30" itemprop="dateCreated datePublished" datetime="2021-06-27T21:58:30+08:00">2021-06-27</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">Edited on</span>
        <time title="Modified: 2021-06-30 17:20:15" itemprop="dateModified" datetime="2021-06-30T17:20:15+08:00">2021-06-30</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/not_advanced_ins.github.io/categories/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/" itemprop="url" rel="index"><span itemprop="name">操作系统</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="基本概念"><a href="#基本概念" class="headerlink" title="基本概念"></a>基本概念</h1><p>和<strong>覆盖技术</strong>和<strong>交换技术</strong>一样，虚拟内存技术也可以用来扩展内存空间。</p>
<h2 id="传统存储管理方式的特点"><a href="#传统存储管理方式的特点" class="headerlink" title="传统存储管理方式的特点"></a>传统存储管理方式的特点</h2><p>传统存储管理方式包括连续存储方式(如单一连续分配)和非连续分配的存储方式(如分页、分段和段页式存储管理方式)，这些管理方式的问题在于，暂时用不到的数据会长期留存在内存当中，使得内存利用率偏低。</p>
<p><strong>一次性</strong> 作业必须一次性全部装入内存之后才能开始运行。这导致：</p>
<ol>
<li>作业很大时因为无法全部装入内存而<strong>无法运行</strong></li>
<li>大量作业要求运行时，因为内存无法容纳所有的大作业而导致<strong>程序并发度下降</strong></li>
</ol>
<p><strong>驻留性</strong> 一旦作业被装入内存，就会一直驻留在内存中，直到作业运行结束。这使得内存中大量暂时用不到的数据驻留在了里面。</p>
<h2 id="局部性原理"><a href="#局部性原理" class="headerlink" title="局部性原理"></a>局部性原理</h2><p>局部性原理是虚拟内存技术能够实现的根据。它包括了时间局部性和空间局部性。</p>
<h2 id="虚拟内存的特征"><a href="#虚拟内存的特征" class="headerlink" title="虚拟内存的特征"></a>虚拟内存的特征</h2><p>基于局部性原理，可以将程序中很快会用到的部分装入内存，暂时用不到的留在外存。当所访问的信息不在内存时，由操作系统负责将所需信息从外存调用到内存中，然后继续执行程序。如果内存空间不够，由操作系统负责将内存中暂时用不到的信息置换到外存中去。<br>在用户视角下，就会看到一个比实际内存大得多的内存。这就是虚拟内存。</p>
<p>它具有以下几个特征：</p>
<ol>
<li>多次性。作业在运行时可以被分成多次调入内存了。</li>
<li>对换性。允许作业运行过程中将作业换入换出。</li>
<li>虚拟性，从逻辑上扩充了内存的容量。</li>
</ol>
<h2 id="实现方式"><a href="#实现方式" class="headerlink" title="实现方式"></a>实现方式</h2><p>虚拟内存的实现需要建立在<strong>离散分配</strong>的内存管理方式的基础之上。在传统的离散分配的内存管理基础上，派生出了请求分页、分段和段页式的存储管理模式。</p>
<ol>
<li>请求调页或请求调段功能</li>
<li>页面/段置换功能。</li>
</ol>
<h1 id="请求分页的管理方式"><a href="#请求分页的管理方式" class="headerlink" title="请求分页的管理方式"></a>请求分页的管理方式</h1><h2 id="页表机制"><a href="#页表机制" class="headerlink" title="页表机制"></a>页表机制</h2><p>在请求分页的管理模式当中，页表的内容得到了扩充，以让操作系统获悉页面是否已经调入内存，或者在外存中的信息。</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>页号</th>
<th>内存块号</th>
<th>状态位</th>
<th>访问字段</th>
<th>修改位</th>
<th>外存地址</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>b</td>
<td>1</td>
<td>10</td>
<td>0</td>
<td>x</td>
</tr>
</tbody>
</table>
</div>
<div class="table-container">
<table>
<thead>
<tr>
<th>新增字段名</th>
<th>释义</th>
</tr>
</thead>
<tbody>
<tr>
<td>状态位</td>
<td>标记是否已经调入内存</td>
</tr>
<tr>
<td>访问字段</td>
<td>记录最近访问的时间</td>
</tr>
<tr>
<td>修改位</td>
<td>页面被调入内存后是否被修改过</td>
</tr>
<tr>
<td>外存地址</td>
<td>页面在外存中的存放位置</td>
</tr>
</tbody>
</table>
</div>
<h2 id="缺页中断机构"><a href="#缺页中断机构" class="headerlink" title="缺页中断机构"></a>缺页中断机构</h2><p>页面不在内存——产生缺页中断——操作系统处理中断<br>此时缺页进程阻塞，放入阻塞队列，调页完成后唤醒进程      </p>
<p>内存中有空闲块——为进程分配一个空闲块——页面装入页块内<br>内存中没有空闲块——调用页面置换算法，并选择一个页面淘汰。页面在内存中被修改过，写回外存。</p>
<p>缺页中断属于内中断。一条指令执行期间，可能会产生多次缺页中断</p>
<h2 id="地址变换机构"><a href="#地址变换机构" class="headerlink" title="地址变换机构"></a>地址变换机构</h2><p>新增了步骤：</p>
<ol>
<li>请求调页</li>
<li>页面置换</li>
<li>修改请求页表中的新增表项</li>
</ol>
<h1 id="页面置换算法"><a href="#页面置换算法" class="headerlink" title="页面置换算法"></a>页面置换算法</h1><h2 id="最佳置换算法-OPT"><a href="#最佳置换算法-OPT" class="headerlink" title="最佳置换算法(OPT)"></a>最佳置换算法(OPT)</h2><h2 id="先进先出置换算法-FIFO"><a href="#先进先出置换算法-FIFO" class="headerlink" title="先进先出置换算法(FIFO)"></a>先进先出置换算法(FIFO)</h2><h2 id="LRU算法"><a href="#LRU算法" class="headerlink" title="LRU算法"></a>LRU算法</h2><h2 id="时钟置换算法-clock"><a href="#时钟置换算法-clock" class="headerlink" title="时钟置换算法(clock)"></a>时钟置换算法(clock)</h2><h2 id="改进CLOCK"><a href="#改进CLOCK" class="headerlink" title="改进CLOCK"></a>改进CLOCK</h2><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><h1 id="页面分配策略"><a href="#页面分配策略" class="headerlink" title="页面分配策略"></a>页面分配策略</h1>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/not_advanced_ins.github.io/page/4/"><i class="fa fa-angle-left" aria-label="Previous page"></i></a><a class="page-number" href="/not_advanced_ins.github.io/">1</a><span class="space">&hellip;</span><a class="page-number" href="/not_advanced_ins.github.io/page/4/">4</a><span class="page-number current">5</span><a class="page-number" href="/not_advanced_ins.github.io/page/6/">6</a><a class="page-number" href="/not_advanced_ins.github.io/page/7/">7</a><a class="extend next" rel="next" href="/not_advanced_ins.github.io/page/6/"><i class="fa fa-angle-right" aria-label="Next page"></i></a>
  </nav>

</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Albert -W</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/muse/" rel="noopener" target="_blank">NexT.Muse</a>
  </div>

    </div>
  </footer>

  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/not_advanced_ins.github.io/js/comments.js"></script><script src="/not_advanced_ins.github.io/js/utils.js"></script><script src="/not_advanced_ins.github.io/js/motion.js"></script><script src="/not_advanced_ins.github.io/js/schemes/muse.js"></script><script src="/not_advanced_ins.github.io/js/next-boot.js"></script>

  




  





</body>
</html>
